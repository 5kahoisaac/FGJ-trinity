name: Test GitHub Models API
on: 
  workflow_dispatch:  # Manual trigger button in Actions tab
  
permissions:
  models: read

jobs:
  test-ai:
    runs-on: ubuntu-latest
    steps:
    - name: Test GitHub Models API
      run: |
        echo "üß™ Testing GitHub Models API..."
        
        # Simple test call to GitHub Models
        RESPONSE=$(curl "https://models.github.ai/inference/chat/completions" \
             -H "Content-Type: application/json" \
             -H "Authorization: Bearer $GITHUB_TOKEN" \
             -d '{
              "messages": [
                  {
                     "role": "user",
                     "content": "Explain the concept of recursion."
                  }
               ],
               "model": "openai/gpt-4o"
            }')
        
        echo "üì° Raw API Response:"
        echo "$RESPONSE"
        echo ""
        
        # Check if API call succeeded
        if echo "$RESPONSE" | jq -e '.choices' >/dev/null 2>&1; then
          echo "‚úÖ SUCCESS: GitHub Models API is working!"
          echo "Model response: $(echo "$RESPONSE" | jq -r '.choices[0].message.content')"
          exit 0
        else
          echo "‚ùå FAILED: API call failed or invalid response"
          echo "Response status: $?"
          exit 1
        fi
